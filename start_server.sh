#!/bin/bash
echo "๐ ะะฐะฟััะบ ะฟัะพะตะบัะฐ FaceSort..."
echo "๐ ะะฐะฑะพัะฐั ะดะธัะตะบัะพัะธั: $(pwd)"
echo "๐ Python ะฒะตััะธั: $(python3 --version)"
echo ""

# ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะฟัะตะดัะดััะธะต ะฟัะพัะตััั
echo "๐ ะััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะฟัะตะดัะดััะธะต ะฟัะพัะตััั..."
pkill -f "python.*main.py" 2>/dev/null || true
sleep 2

# ะะฐะฟััะบะฐะตะผ ัะตัะฒะตั
echo "๐ ะะฐะฟััะบะฐะตะผ ัะตัะฒะตั FaceSort..."
python3 main.py &
SERVER_PID=$!

echo "โ ะกะตัะฒะตั ะทะฐะฟััะตะฝ ั PID: $SERVER_PID"
echo "๐ URL: http://localhost:8000"
echo "๐ ะัะพะฒะตัะบะฐ ัะตัะตะท 5 ัะตะบัะฝะด..."

sleep 5

# ะัะพะฒะตััะตะผ, ััะพ ัะตัะฒะตั ัะฐะฑะพัะฐะตั
if curl -s http://localhost:8000/api/tasks > /dev/null 2>&1; then
    echo "โ ะกะตัะฒะตั ัะฐะฑะพัะฐะตั!"
    echo "๐ฏ ะัะบัะพะนัะต http://localhost:8000 ะฒ ะฑัะฐัะทะตัะต"
    echo "๐ง ะัะฟะพะปัะทัะนัะต ะบะฝะพะฟะบั '๐ ะะฑัะธะต' ะดะปั ัะตััะธัะพะฒะฐะฝะธั"
else
    echo "โ ะกะตัะฒะตั ะฝะต ะพัะฒะตัะฐะตั"
    echo "๐ ะัะพะฒะตัััะต ะปะพะณะธ ะฒััะต"
fi

echo ""
echo "๐ ะะปั ะพััะฐะฝะพะฒะบะธ ัะตัะฒะตัะฐ: kill $SERVER_PID"
echo "๐ ะะปะธ ะฝะฐะถะผะธัะต Ctrl+C"
